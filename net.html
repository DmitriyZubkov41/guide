<html><head></head><body>
<title>Сетевые утилиты</title>

<a href="https://zalinux.ru/?p=3705">Как использовать команду ip в Linux</a>

    <h3><b>ifconfig</b></h3>
    Команда ifconfig (Interface Configuration) — одна из наиболее распространенных и полезных команд в операционной системе Linux. Она помогает управлять сетевыми интерфейсами. С помощью ifconfig администраторы могут быстро и легко получать информацию о текущем состоянии сетевых интерфейсов и конфигурировать их параметры: IP-адрес, маску, широковещательный адрес, MTU (максимальный размер пакета данных) и другие. Команда также позволяет изменять состояние интерфейсов, включать или выключать их.<br>    
    ifconfig — стандартная утилита в большинстве дистрибутивов Linux. Обычно она устанавливается вместе с операционной системой, но в некоторых современных дистрибутивах Linux заменяется на более новую утилиту под названием ip. ifconfig устанавливается в составе net-tools:
<p>
    <font color="green">sudo apt install net-tools</font>

<h2 align="center">Перенаправление порта на локальной машине Linux с помощью различных сетевых утилит</h3>

<h3 align="center">Команда netcat</h3>
Установка в Linux на базе Debian (ubuntu например): <font color="green">apt-get install -y netcat</font><br>
После установки netcat будет создана символическая ссылка nc, указывающая на команду netcat.
<p>Синтаксис команды:<p>
    <i>nc [options] host port</i>
<p>
    По умолчанию Netcat пытается установить TCP-соединение с указанным хостом и портом. Если вы хотите установить UDP-соединение, используйте -u опцию:<p>
<i>nc -u host port</i>
<h3>Сканирование портов</h3>
Сканирование портов является одним из наиболее распространенных способов использования Netcat. Вы можете сканировать один порт или диапазон портов.<br>
Например, для поиска открытых портов в диапазоне 20-80 вы должны использовать следующую команду:<p>
<i>nc -z -v 10.9.9.9 20-80</i>
<p>
Опция -z скажет nc сканировать только открытые порты, без отправки каких – либо данных на них и -v дает возможность предоставления более подробной информации.
<p>
    <h3>Запуск сервера и клиента</h3>
<b>Сервер:</b><br>
    <font color="green">nc -l 2000</font>
<p>
    Флаг -l указывает netcat прослушивать указанный порт, 2000.<br>
    После выполнения процесс будет прослушиваться бесконечно, пока не будет остановлен.
<p>
    Другие опции:
<ul>
    <li> - v Подробный отчёт. У меня при использовании этой опции выдаёт ошибку: <font color="red">nc: getnameinfo: Temporary failure in name resolution</font>.
<li> - k Сервер не завершит работу при завершении работы подключенного клиента:
<li> -p Определяем порт. <font color=red>Непонятно: мы и так без этой опции определяем порт, который нужно слушать</font>.
</ul>
<p>
    <b>Клиент:</b><br>
    <p>
    Откроем новый терминал (клиент) и отправим сообщение на перенаправленный порт 2000:
    <p>
    <font color=green>$ echo "Test message" | nc localhost 2000</font><br>
    В этом примере мы отправили наше тестовое сообщение на локальную машину порт 2000. На сервере, слушающий порт 2000, получим это сообщение.
<p>
    Другой пример работы клиента:
<p>
<font color="green">nc localhost 2000</font> или <font color="green">nc 127.0.0.1 2000</font><br>
<p>
Выполнение этой команды откроет процесс netcat, который подключается к localhost порт 2000. Теперь можем печатать сообщения и они будут появляться на сервере.

<h3 align="center">iptables</h3>
iptables - это мощный инструмент брандмауэра, который позволяет нам контролировать сетевой трафик. Более того, мы можем использовать iptables для перенаправления портов, изменяя сетевые пакеты по мере их прохождения через сетевой стек ядра Linux.


<h3 align="center">Использование socat</h3>
Установим socat:
<br><font color="green">$ sudo apt-get install socat</font>
<p>
Затем мы воспользуемся этим инструментом для определения правила:
<p>
<font color=green>$ sudo socat TCP-LISTEN:80,fork TCP:localhost:8080</font>
<p>
После запуска socat с этим правилом он прослушивает порт 80 и перенаправляет трафик на порт 8080.
<br>
Здесь мы использовали несколько вариантов:
<ul>
<li> <b>TCP-LISTEN: 80</b> устанавливает исходный порт, на котором socat прослушивает входящие соединения, на 80
<li> <b>fork</b> позволяет socat обрабатывать несколько подключений
<li> <b>TCP:localhost: 8080</b> перенаправляет трафик на выбранный порт назначения на локальной машине
</ul>
Теперь мы можем добиться гибкого и эффективного перенаправления сетевого трафика на нужные порты на локальной машине.
<br>
Поскольку socat автоматически не продолжает настройку перенаправления портов, мы можем создать сценарий запуска, чтобы гарантировать запуск настройки при загрузке системы. Описание этого файла на <a href="https://translated.turbopages.org/proxy_u/en-ru.ru.c4f138db-668b9bcd-6a773b5d-74722d776562/https/www.baeldung.com/linux/port-redirection">этой странице</a>
<p>
Шаблон командной строки, который ожидает socat:
<p>
socat additionalOptions addr1 addr2
<p>
additionalOptions - опции, которые могут добавлять возможности логирования информации, управления направлением передачи данных;
<p>
addr1 - источник данных или приемник (влияет использование флага U или u), это может быть сокет, файл, пайп или виртуальный терминал;
<p>
addr2 - источник данных или приемник (влияет использование флага U или u), это может быть сокет, файл, пайп или виртуальный терминал;
<p>
Для его корректной работы нужно обязательно писать 2 адреса. Причем адрес не обязательно должен быть адресом, это может быть и приложение, и стандартный вывод на экран.
<p>
Например, чтобы использовать socat как netcat в качестве TCP сервера, можно запустить вот такую команду:
<p>
socat TCP-LISTEN:4545, STDOUT
<p>
Для коннекта можно использовать netcat:
<p>
nc localhost 4545
<p>
При таком использовании, socat дает возможность пересылать сообщения в обе стороны, но если добавить флаг "-u", то общение будет только от клиента к серверу.


<h3 align="center">UFW</h3>
UFW (Простой брандмауэр) - это инструмент для управления правилами брандмауэра в Linux. Более того, UFW предоставляет упрощенный интерфейс к iptables и позволяет нам настраивать перенаправление портов. Определяя правила UFW, мы можем перенаправлять сетевой трафик с одного порта на другой.
<h3 align="center">firewalld</h3>
firewalld - это полноценный брандмауэр для систем Linux. firewalld предоставляет интерфейс для настройки правил брандмауэра и управления.
h3 align="center">Использование nftables</h3>
nftables - это платформа фильтрации пакетов для Linux. Она позволяет осуществлять детальный контроль над сетевым трафиком с помощью правил и таблиц. Более того, с помощью nftables мы можем настроить перенаправление портов. Это достигается путем определения правил, которые перенаправляют входящий трафик с одного порта на другой на локальной машине.


<h2 align="center">Как отправить TCP пакет на определенный ip:порт в Linux</h2>

Для отправки tcp пакета на определенный IP адрес и определенный порт, можно воспользоваться следующей командой:
<p>
<font color="green">echo -n "test" >/dev/tcp/1.2.3.4/12345</font>
<p>
1.2.3.4 - это IP адрес, на который мы будем посылать наш tcp пакет.<br>
12345 - это порт, на который мы будем посылать наш tcp пакет

<h3>Команда ping</h3>
Для проверки доступности 
Установка: apt-get install iputils-ping

<h3 align="center">Команда curl</h3>
<a href="https://losst.pro/kak-polzovatsya-curl">Как пользоваться curl</a>
<p>
curl - это больше чем просто утилита командной строки для Linux или Windows. Это набор библиотек, в которых реализуются базовые возможности работы с URL страницами и передачи файлов. Библиотека поддерживает работу с протоколами: FTP, FTPS, HTTP, HTTPS, TFTP, SCP, SFTP, Telnet, DICT, LDAP, а также POP3, IMAP и SMTP. Она отлично подходит для имитации действий пользователя на страницах и других операций с URL адресами.
<p>
    <font color=green>apt-get install -y curl</font>
<p>
Синтаксис команды:<br>
<font color=green>curl опции ссылка</font>
<p>
    Опции:
<ul>
    <li> -# - отображать простой прогресс-бар во время загрузки;
    <li>    -0 - использовать протокол http 1.0;
    <li>    -1 - использовать протокол шифрования tlsv1;
    <li>    -2 - использовать sslv2;
    <li>    -3 - использовать sslv3;
        <li>    -4 - использовать ipv4;
            <li>    -6 - использовать ipv6;
                <li>    -A - указать свой USER_AGENT;
    <li>    -b - сохранить Cookie в файл;
    <li>    -c - отправить Cookie на сервер из файла;
    <li>    -C - продолжить загрузку файла с места разрыва или указанного смещения;
    <li>    -m - максимальное время ожидания ответа от сервера;
    <li>    -d - отправить данные методом POST;
    <li>    -D - сохранить заголовки, возвращенные сервером в файл;
    <li>    -e - задать поле Referer-uri, указывает с какого сайта пришел пользователь;
    <li>    -E - использовать внешний сертификат SSL;
    <li>    -f - не выводить сообщения об ошибках;
    <li>    -F - отправить данные в виде формы;
    <li>    -G - если эта опция включена, то все данные, указанные в опции -d будут передаваться методом GET;
    <li>    -H - передать заголовки на сервер;
    <li>    -I - получать только HTTP заголовок, а все содержимое страницы игнорировать;
    <li>    -j - прочитать и отправить cookie из файла;
    <li>    -J - удалить заголовок из запроса;
    <li>    -L - принимать и обрабатывать перенаправления;
    <li>    -s - максимальное количество перенаправлений с помощью Location;
    <li>    -o - выводить контент страницы в файл;
    <li>    -O - сохранять контент в файл с именем страницы или файла на сервере;
    <li>    -p - использовать прокси;
    <li>    --proto - указать протокол, который нужно использовать;
    <li>    -R -  сохранять время последнего изменения удаленного файла;
    <li>    -s - выводить минимум информации об ошибках;
    <li>    -S - выводить сообщения об ошибках;
    <li>    -T - загрузить файл на сервер;
    <li>    -v - максимально подробный вывод;
    <li>    -y - минимальная скорость загрузки;
    <li>   -Y - максимальная скорость загрузки;
    <li>    -z - скачать файл, только если он был модифицирован позже указанного времени;
    <li>   -V - вывести версию.
    </ul>
<p>
    Самая частая задача - это загрузка файлов linux. Скачать файл очень просто. Для этого достаточно передать утилите в параметрах имя файла или html страницы:
<p>
    <b>curl https://raw.githubusercontent.com/curl/curl/master/README.md</b><br>
    Но все содержимое файла будет отправлено на стандартный вывод. Чтобы записать его в какой-либо файл используйте опцию -o:
<p>
    <b>curl -o readme.txt https://raw.githubusercontent.com/curl/curl/master/README.md</b>

<h3 align="center"><a href="https://losst.pro/nastrojka-seti-v-linux?ysclid=lyh1ni3gt638281465">Утилита IP</a></h3>

<h3 align="center">Утилита tracerote</h3>
По умолчанию не входит в ubuntu и её следует установить:<br>
<font color="green">sudo apt install inetutils-traceroute</font><br>
Эта утилита позволяет посмотреть маршрут хождения пакета данных до IP-адреса. Синтаксис:<br>
<font color="green">traceroute IP</font><br>
Вместо IP можно писать домен.<br>
Символы астериска (звёздочки) в начале строки означают об отсутствии ответа на запрос.


<br><br><br><br></body></html>
