<html><head></head><body>
<title>SSH</title>
<h2 align=center>Использование протокола удалённого управления SSH</h2>
1. Основные понятия:<br>
SSH (Secure Shell) — это надёжный криптографический сетевой протокол, который используют для безопасного удалённого управления системами и безопасной передачи данных в небезопасных сетях, таких как интернет.
<p>
<b>Основные понятия и принципы работы SSH:</b>
<ol>
<li> Аутентификация. SSH использует ключи для аутентификации. У пользователя есть приватный ключ, который он держит в тайне, и публичный ключ, которым делится с сервером. При подключении SSH сервер проверяет приватный ключ пользователя и сравнивает его с публичным ключом на сервере.
<li>. Шифрование. Все данные, передаваемые по SSH-соединению, шифруются. Это означает, что, даже если данные перехватят, они будут бесполезны без приватного ключа.
<li>. Целостность данных. SSH также проверяет, не были ли данные изменены во время передачи.
<li>. Конфиденциальность. SSH обеспечивает конфиденциальность данных, шифруя их.
</ol>
<p>
<b>Применение SSH в робототехнике:</b>
<ul>
<li> Удалённое управление роботом. SSH можно использовать для удалённого управления роботом. Это особенно полезно, когда робот находится в отдалении от оператора.
<li> Передача данных. SSH также можно использовать для безопасной передачи данных между роботом и сервером или другим роботом.
<li> Туннелирование. SSH позволяет создавать безопасные туннели для других протоколов, что будет полезно при передаче информации, требующей высокого уровня безопасности.
<li> Отладка. SSH можно использовать для отладки программного обеспечения робота. Программисты могут подключаться к роботу через SSH и запускать команды для тестирования и отладки программного обеспечения.
</ul>

<h3 align=center>Установка SSH-сервера</h3>
В большинстве дистрибутивов Linux SSH-сервер устанавливается по умолчанию. Если нет, его можно установить с помощью менеджера пакетов. Например, в Ubuntu это можно сделать командой:<br>
<font color=green>sudo apt-get install openssh-server</font>

<h3 align=center><a href="https://losst.pro/kak-polzovatsya-ssh">Синтаксис команды</a></h3>
Синтаксис команды выглядит следующим образом:
<p>
ssh [опции] имя пользователя@сервер [команда]
<p>
Важно заметить что ssh может работать по двум версиям протокола. Версии 1 и 2. Понятное дело, что версия 2 лучше и поддерживает больше типов шифрования и аутентификации. Больше в этой статье об отличиях протоколов мы говорить не будем и я буду подразумевать что вы используете версию 2.

<h3>Опции команды SSH</h3>
Теперь давайте рассмотрим самые основные опции команды ssh:
<ul>
<li> f - перевести ssh в фоновый режим;
<li> g - разрешить удаленным машинам обращаться к локальным портам;
<li> l - имя пользователя в системе;
<li> n - перенаправить стандартный вывод в /dev/null;
<li> p - порт ssh на удаленной машине;
<li> q - не показывать сообщения об ошибках;
<li> v - режим отладки;
<li> x - отключить перенаправление X11;
<li> X - включить перенаправление Х11;
<li> C - включить сжатие.
</ul>
Это далеко не все опции утилиты, остальные выходят за рамки данной статьи. Многие настройки работы ssh можно изменять через конфигурационный файл ~/.ssh/config но здесь мы это тоже подробно рассматривать не будем.

<h3 align=center>Настройка SSH-сервера и клиента</h3>
В SSH один компьютер может быть одновроеменно клиентом и сервером. Но для клиента и сервера существует свой файл конфигурации. Каждый файл конфигурации имеет ряд настроек. При этом большинство настроек могут принимать одно из двух значений: yes (настройка включена) и no (настройка отключена)
<p>
<b>Конфигурация клиента:</b><br>
Конфигурация клиента размещена в файле /etc/ssh/ssh_config. Но стоит отметить, что это общий файл, который применяется ко всем пользователям в системе, подключающихся по SSH к удаленному хосту. Однако отдельный пользователь может для себя переопределить эти настройки, если создаст файл .ssh_config в домашнем каталоге в подпапке .ssh. Еще один способ переопределить настройки - задать их непосредственно в консоли при вызове команды ssh
<p>
<b>Наиболее используемые настройки клиента (/etc/ssh/ssh_config):</b>
<ul>
<li> Host: эта опция применяется к хосту, к которому подключается пользователь. Она ограничивает последующие объявления определенным хостом (вплоть до следующего слова Host). Имя хоста берется то, которое указывается в командной строке. Обычно эта настройка используется для добавления дополнительной безопасности для определенных хостов. Также можно использовать подстановочные знаки, такие как * и ? для ссылки на более чем одно имя хоста. Например, в файле /etc/ssh/ssh_config по умолчанию можно увидеть следующую строку<br>
<b>Host *</b><br>
Она говорит о применении последующих настроек ко всем хостам
<li> CheckHostIP: если для этой опции установлено значение "yes" (значение по умолчанию), то SSH проверит IP-адрес хоста в файле known_hosts. Обычно применяется для защиты от подмены DNS или IP-адреса.
<li> Ciphers:. эта настройка принимает несколько аргументов и используется для указания порядка, в котором следует использовать различные алгоритмы шифрования в сеансе SSHv2.
<li> Compression: значения "yes" или "no" для этой настройки определяют, следует ли использовать сжатие в сеансе SSH. По умолчанию не используется.
<li> ForwardX11: определяет, будут ли пересылаться соединения X11. Если установлено значение "yes", графические экраны из сеанса SSH можно пересылать через защищенный туннель. Если не надо включать пересылку X по умолчанию, используйте опцию -X в командной строке при установлении сеанса SSH.
<li> PasswordAuthentication: указывает, надо ли использовать аутентификацию по паролю (по умолчанию используется - значение "yes"). В безопасной среде, в которой для аутентификации применяются ключи, для этой настройки можно установить значение "no", чтобы полностью отключить аутентификацию по паролю.
</ul>
<b>Конфигурация сервера:</b><br>
Конфигурация сервера располагается в файле /etc/ssh/sshd_config, и при необходимости изменить конфигурацию сервера как раз мы можем поместить нужные нам настройки в этот файл. Некоторые настройки сервера повторяют настройки клиента, но есть и специфичные для сервера:
<ul>
<li> Port<br>
По умолчанию ssh работает на порту 22. Но такое поведение небезопасно, поскольку злоумышленник знает этот порт и может попробовать выполнить Bruteforce атаку для перебора пароля. Порт задается строчкой: Port
<li> Протокол SSH<br>
По умолчанию сервер ssh может работать по двум версиям протокола, для совместимости. Чтобы использовать только протокол версии два раскомментируйте строчку: Protocol 2
<li> AllowTcpForwarding: указывает, надо ли разрешить клиентам выполнять переадресацию TCP-портов. Если значение "yes" - разрешена (значение по умолчанию), если no - не разрешена.
<li> Port: порт, который прослушивает процесс SSH. По умолчанию это порт 22.
<li> PermitRootLogin<br> определяет, разрешён ли вход в систему от имени root через SSH. Обычно рекомендуется установить значение no для улучшения безопасности.
<li> PermitEmptyPasswords: указывает, надо ли вы разрешить вход в систему с пустым паролем. По умолчанию значение - no, то есть вход с пустым паролем запрещен
<li> Выполнение X11 приложений<br>
Не все знают но есть возможность использовать ssh для запуска полноценных X11 приложений. Об этом мы поговорим ниже, но чтобы все заработало необходимо разрешить эту возможность на стороне сервера, добавьте такую строчку:<br>
X11Forwarding yes
<li> Доступ только определенного пользователя к SSH<br>
Мы можем разрешить доступ к ssh только для определенного пользователя или группы. Для этого  добавьте строчки:<br>
AllowUsers User1, User2, User3<br>
AllowGroups Group1, Group2, Group3<br>
Здесь User1 и Group1 - пользователь и группа к которым нужно разрешить доступ.
<li> PasswordAuthentication определяет, разрешено ли аутентифицироваться с помощью пароля. Если вы используете ключи SSH для аутентификации, вы можете захотеть отключить аутентификацию по паролю для улучшения безопасности.
</ul>
После внесения изменений в файл конфигурации перезагрузите SSH-сервер, чтобы применить новые настройки. Вы можете сделать это с помощью команды:<br><b>sudo systemctl restart ssh</b>
<p>
Вы можете управлять SSH-сервером с помощью команд sudo systemctl start ssh, sudo systemctl stop ssh, sudo systemctl restart ssh, sudosystemctl status ssh для запуска, остановки, перезагрузки и проверки статуса сервера соответственно.

<h3>Создание и управление ключами SSH</h3>
Использование ssh пароля для входа на сервер не только неудобно но и небезопасно, потому что этот пароль в любой момент может быть подобран. Самый надежный и часто используемый способ аутентификации - с помощью пары ключей RSA. Секретный ключ хранится на компьютере, а публичный используется на сервере для удостоверения пользователя.
<p>
<b>Создание ключей SSH.</b><br>
Ключи SSH можно создать с помощью команды:<br>
<b>ssh-keygen</b><br>
Она создаст приватный и публичный ключи в вашем домашнем каталоге (по умолчанию в ~/.ssh/id_rsa и ~/.ssh/id_rsa.pub соответственно).
<p>
Во время создания ключа нужно будет ответить на несколько вопросов, расположение оставляйте по умолчанию, если хотите подключаться без пароля - поле Passphare тоже оставьте пустым.<br>
Затем отправляем ключ на сервер:
<p>
 <b>ssh-copy-id -i ~/.ssh/id_rsa.pub user@host</b>
<p>
Вот и все. Теперь при попытке подключится к этому серверу пароль запрашиваться не будет, а сразу произойдет подключение.
<p>
<b>Управление ключами SSH.</b><br>
Вам нужно скопировать свой публичный ключ на удалённый сервер с помощью команды ssh-copy-id username@hostname. Это позволит вам подключаться к серверу без ввода пароля.
<p>
<b>Удалённое подключение к роботу по SSH</b><br>
После настройки ключей SSH вы можете подключиться к роботу с помощью команды ssh username@hostname. Вам нужно заменить username и hostname на соответствующие значения для вашего робота. Если вы используете нестандартный порт для SSH, можете указать его с помощью флага -p, например ssh -p 2222 username@hostname.
<p>
<b>SSH для передачи файлов между локальным компьютером и удалённым роботом</b><br>
Копирование файлов для передачи файлов между локальным компьютером и удалённым роботом можно использовать утилиту scp (Secure Copy) или rsync (Remote Sync), которые работают по протоколу SSH.<br>
Копирование файла с локального компьютера на удалённый хост:
<p>
scp /path/to/local/file<br>
username@remote_host:/path/to/remote/directory
<p>
Копирование файла с удалённого хоста на локальный компьютер:
<p>
scp username@remote_host:/path/to/remote/file/path/to/local/directory
<p>
Для монтирования файловой системы удалённого робота на локальном компьютере можно использовать SSHFS (SSH File System). Сначала вам нужно установить SSHFS с помощью менеджера пакетов вашего дистрибутива.
<p>
<b>Использование Rsync (Remote Sync) на базе SSH:</b><br>
Синхронизация локального каталога с каталогом на удалённом хосте:<br>
rsync -avz /local/directory/username@remote_host:/remote/directory
<p>
Синхронизация каталога на удалённом хосте с локальным каталогом:<br>
rsync -avz username@remote_host:/remote/directory//local/directory
<p>
<b>SSHFS (SSH File System)</b><br>
Для монтирования файловой системы удалённого робота на локальном компьютере можно использовать SSHFS (SSH File System). Сначала установите sshfs с помощью менеджера пакетов вашего дистрибутива.<br>
Установка SSHFS на Ubuntu:<br>
sudo apt-get install sshfs
<p>
После установки вы можете монтировать удалённую файловую систему следующим образом:<br>
sshfs username@remote_host:/remote/directory /local/mountpoint
<p>
Чтобы отмонтировать файловую систему, используйте команду fusermount с флагом -u:<br>
fusermount -u /local/mountpoint






<br><br><br><br><br><br><br></body></html>
