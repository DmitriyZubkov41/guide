<html><head></head><body>
<title>Устройства, разъёмы</title>
<h2 align=center><a href="https://copter-space.gitbook.io/uchebnik-mashinnoe-zrenie-tom-2/razdel-2/podklyuchenie-raspberry-pi-k-polyotnomu-kontrolleru-pixhawk-i-upravlenie-realnym-dronom-s-pomoshyu-r">Подключение Raspberry PI к полётному контроллеру Pixhawk и управление реальным дроном с помощью ROS</a></h2>
Управление реальным дроном по протоколу mavros аналогично управлению виртуальным дроном, однако для реального дрона необходимо осуществить физическое подключение полётного контроллера к бортовому компьютеру (а также собрать и настроить сам дрон).
<p>
<b>Схема подключения Raspberry PI к Pixhawk:</b><br>
Подключение бортового компьютера к полётному контроллеру возможно двумя способами: по интерфейсу UART через порт telem2, а также по интерфейсу USB. Ниже описаны оба способа.
<p>
Подключение UART осуществляетсся с помощью соединения понов GPIO Raspberry PI с портом telem2 полётного контроллера по следующей схеме:<br>
<img src="./images/device.jpeg">
<p>
Подключение по mavros к полётному контроллеру выполняется с помощью команды:<br>
<b>roslaunch mavros px4.launch fcu_url:= /dev/ttyAMA0:921600</b>
<p>
При этом полётный контроллер дрона должен быть настроен и откалиброван, в программе управления QGroundControl не должно выдавать ошибок, иначе полётный контроллер может не выдавать хартбит по mavros. Лишние проверки можно отключить с помощью специальных параметров-заглушек (circuit breakers) полётного контроллера:<br>
<img src="./images/device1.png">
<p>
Также в параметрах ПК должна быть правильно установлена скорость обмена по UART – параметр SYS_COMPANION = 921600 baud, 8N1.
Если процесс mavros выдаёт ошибку и падает при запуске – необходимо убедиться, что на Raspberry PI отключена блокировка UART операционной системой (с помощью raspi-config или в конфигурационном файле config.txt). 
<h3>Проверка подключения, запуск/остановка моторов дрона</h3>
После подключения полётного контроллера к бортовому компьютеру можно проверить работу mavros с помощью арминга (запуска моторов) дрона.<br>
<font color=red>Обязательно снимите пропеллеры при первом тестовом запуске моторов!</font>
<p>
Запуск моторов осуществляется с помощью команды:<br> 
rosservice call /mavros/cmd/arming "value: true"
<p>
Остановить моторы можно с помощью команды:<br>
rosservice call /mavros/cmd/arming "value: false"












<br><br><br><br><br><br><br></body></html>
